---
config:
  layout: elk
  theme: default
---
%% ========================================================================
%% VENUS & Prep API Architecture
%% ========================================================================
%% Created: 2026-01-23
%% Sources:
%%   - VENUS API webinar (Michael Thorne, Sr. Manager Software Engineering)
%%   - VENUS Power Steps webinar (Corey Edwards)
%% Purpose: Show API capabilities for integration and Connectivity planning
%% Author: Marcelo Caballero
%% ========================================================================

flowchart TB
    %% ==================== EXTERNAL SYSTEMS ====================
    subgraph EXTERNAL["EXTERNAL SYSTEMS (Customer Applications)"]
        direction LR
        LIMS["LIMS Systems<br/>LabWare, Benchling<br/>Thermo SampleManager<br/>LabVantage"]:::external
        ELN["ELN / Notebooks<br/>Jupyter, LIMS ELN<br/>Data analysis"]:::external
        CUSTOM["Custom Apps<br/>Python, C#, Java<br/>Customer-built"]:::external
        ORCHESTRATOR["Orchestrators<br/>Workflow engines<br/>Scheduling systems"]:::external
    end

    %% ==================== VENUS API ====================
    subgraph VENUS_API["VENUS REST API (Venus 6+)"]
        direction TB

        subgraph API_ENDPOINTS["API Endpoints"]
            direction LR
            EP_START["/methods/start<br/>POST: Execute method<br/>Pass worklist, params"]:::api
            EP_STATUS["/status<br/>GET: Current state<br/>Running/Idle/Error"]:::api
            EP_HISTORY["/runs/history<br/>GET: Run records<br/>Filter by date"]:::api
            EP_CAMERA["/camera<br/>GET: DeckWatch control<br/>Snapshot, record"]:::api
        end

        subgraph API_FEATURES["API Features"]
            direction LR
            SWAGGER["Swagger Docs<br/>Included with Venus<br/>Interactive testing"]:::api
            SDK["SDK Options<br/>Python, C#, Java<br/>Auto-generated"]:::api
            DEVPORTAL["Developer Portal<br/>Documentation<br/>Code samples"]:::api
        end

        subgraph API_USES["Use Cases"]
            direction LR
            USE_START["Programmatic Start<br/>LIMS triggers method<br/>No manual intervention"]:::api
            USE_MONITOR["Remote Monitoring<br/>Check status via API<br/>Error notifications"]:::api
            USE_DATA["Data Retrieval<br/>Get run results<br/>Export to LIMS"]:::api
        end
    end

    %% ==================== PREP API ====================
    subgraph PREP_API["MICROLAB PREP API (Separate)"]
        direction TB

        subgraph PREP_ENDPOINTS["Prep API Capabilities"]
            direction LR
            PREP_PROTO["Protocol as Bucket<br/>Modify ANY parameter<br/>At runtime"]:::prep
            PREP_CAMERA["Camera Detection<br/>Labware confidence scores<br/>Visual verification"]:::prep
            PREP_INJECT["Variable Injection<br/>Runtime data insert<br/>Dynamic worklists"]:::prep
            PREP_SWAP["Labware Swapping<br/>Change plate type<br/>Mid-run flexibility"]:::prep
        end

        subgraph PREP_FEATURES["Prep API Features"]
            direction LR
            PREP_JSON["JSON/CSV Output<br/>New in 3.3.0<br/>Easy parsing"]:::prep
            PREP_RDP["Remote Desktop<br/>v3.3.0+<br/>Remote operation"]:::prep
            PREP_TWILIO["Integration Demo<br/>Twilio SMS<br/>Run notifications"]:::prep
        end

        subgraph PREP_ADVANCED["Advanced Capabilities"]
            direction LR
            PREP_MODIFY["Protocol Modification<br/>Change params post-load<br/>More flexible than Venus"]:::prep
            PREP_ERROR["External Error Logic<br/>Customer app handles<br/>Recovery decisions"]:::prep
        end
    end

    %% ==================== LIMS INTEGRATION METHODS ====================
    subgraph LIMS_METHODS["LIMS INTEGRATION (3 Methods)"]
        direction TB

        subgraph METHOD1["Method 1: Shared Folder"]
            direction LR
            M1_FLOW["LIMS → File → VENUS<br/>CSV/XML worklist<br/>Watched folder"]:::method
            M1_PROS["Simple setup<br/>No coding<br/>Works offline"]:::method
            M1_CONS["One-way<br/>Manual results<br/>File lock issues"]:::gap
        end

        subgraph METHOD2["Method 2: REST API"]
            direction LR
            M2_FLOW["LIMS ↔ API ↔ VENUS<br/>Bidirectional<br/>Real-time"]:::method
            M2_PROS["Two-way data<br/>Real-time status<br/>Modern approach"]:::method
            M2_CONS["Requires Venus 6<br/>Network dependency<br/>API docs finalizing"]:::gap
        end

        subgraph METHOD3["Method 3: Database"]
            direction LR
            M3_FLOW["LIMS → DB ← VENUS<br/>Direct SQL access<br/>Shared tables"]:::method
            M3_PROS["Fast queries<br/>Complex data<br/>Enterprise ready"]:::method
            M3_CONS["DBA required<br/>Schema coupling<br/>Security concerns"]:::gap
        end
    end

    %% ==================== PRE-BUILT CONNECTORS ====================
    subgraph CONNECTORS["CERTIFIED CONNECTORS (4 Pre-Built)"]
        direction LR
        CONN_LW["LabWare<br/>Pre-built<br/>Certified"]:::connector
        CONN_BENCH["Benchling<br/>Pre-built<br/>Certified"]:::connector
        CONN_THERMO["Thermo<br/>SampleManager<br/>Certified"]:::connector
        CONN_LV["LabVantage<br/>Pre-built<br/>Certified"]:::connector
        CONN_CUSTOM["All Others<br/>Custom build<br/>2-6 months effort"]:::gap
    end

    %% ==================== DATA FLOWS ====================
    EXTERNAL --> VENUS_API
    EXTERNAL --> PREP_API

    VENUS_API --> LIMS_METHODS
    PREP_API --> LIMS_METHODS

    LIMS_METHODS --> CONNECTORS

    %% ==================== CONNECTIVITY OPPORTUNITY ====================
    subgraph CONNECTIVITY_OPP["CONNECTIVITY OPPORTUNITY"]
        direction LR
        OPP1["Unified API Gateway<br/>Single endpoint<br/>All instruments"]:::connectivity
        OPP2["Connector Marketplace<br/>Pre-built integrations<br/>Community contributed"]:::connectivity
        OPP3["API Monitoring<br/>Health dashboards<br/>Error tracking"]:::connectivity
    end

    CONNECTORS --> CONNECTIVITY_OPP

    %% ==================== LEGEND ====================
    subgraph Legend["LEGEND"]
        LEG_EXT["External System"]:::external
        LEG_API["Venus API"]:::api
        LEG_PREP["Prep API"]:::prep
        LEG_METHOD["Integration Method"]:::method
        LEG_CONN["Certified Connector"]:::connector
        LEG_GAP["Gap / Limitation"]:::gap
        LEG_CONN_OPP["Connectivity Fills"]:::connectivity
    end

    %% ==================== STYLING ====================
    classDef external fill:#f5f5f5,stroke:#666,stroke-width:2px,color:#000
    classDef api fill:#e3f2fd,stroke:#2196f3,stroke-width:2px,color:#000
    classDef prep fill:#e8f5e9,stroke:#4caf50,stroke-width:2px,color:#000
    classDef method fill:#fff3e0,stroke:#ff9800,stroke-width:2px,color:#000
    classDef connector fill:#e1f5e1,stroke:#4caf50,stroke-width:2px,color:#000
    classDef gap fill:#ffebee,stroke:#f44336,stroke-width:2px,stroke-dasharray:5 5,color:#000
    classDef connectivity fill:#f3e5f5,stroke:#9c27b0,stroke-width:3px,color:#000,font-weight:bold

    style VENUS_API fill:#ffffff,stroke:#2196f3,stroke-width:2px
    style PREP_API fill:#ffffff,stroke:#4caf50,stroke-width:2px
    style LIMS_METHODS fill:#ffffff,stroke:#ff9800,stroke-width:2px
    style Legend fill:#f5f5f5,stroke:#666,stroke-width:1px
